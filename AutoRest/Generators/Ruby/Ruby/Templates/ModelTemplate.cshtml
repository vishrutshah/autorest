@using System
@using System.Linq
@using Microsoft.Rest.Generator.ClientModel
@using Microsoft.Rest.Generator.Ruby.TemplateModels
@inherits Microsoft.Rest.Generator.Template<Microsoft.Rest.Generator.Ruby.ModelTemplateModel>
# encoding: utf-8
@Header("# ")
@EmptyLine
module @(Settings.Namespace)
  module Models
    #
    @WrapComment("# ", string.IsNullOrEmpty(Model.Documentation) ? "Model object." : Model.Documentation)
    #
    class @Model.Name@(Model.GetBaseTypeName())
    @if (Model.Includes.Any())
    {
      @EmptyLine
        foreach (var include in Model.Includes)
        {
      @:include @include
        }
      @EmptyLine
    }
    
    @if (Model.IsPolymorphic && Model.BaseModelType == null)
    {
      @:@@@@discriminatorMap = Hash.new
      @:@@@@discriminatorMap["@Model.SerializedName"] = "@Model.Name.ToLowerInvariant()"
      foreach (var derivedType in Model.DerivedTypes)
      {
      @:@@@@discriminatorMap["@derivedType.SerializedName"] = "@derivedType.Name.ToLowerInvariant()"
      }
    }
    
    @if (Model.IsPolymorphic)
    {
    @EmptyLine
    @:def initialize
    @:  @@@Model.PolymorphicDiscriminatorProperty = "@Model.SerializedName"
    @:end
    @EmptyLine
    @:attr_accessor :@Model.PolymorphicDiscriminatorProperty
    }
    
    @foreach (var property in Model.PropertyTemplateModels)
    {
      @:@WrapComment("# ", string.Format("@return {0}{1}", property.Type.GetYardDocumentation(), property.Documentation))
      // @:@(property.IsReadOnly ? "attr_reader" : "attr_accessor") :@property.Name
      @:attr_accessor :@property.Name
      @EmptyLine
      @:
    }

      @EmptyLine
      #
      @WrapComment("# ", string.Format("Mapper for {0} class as Ruby Hash.", Model.Name))
      # This will be used for serialization/deserialization.
      #
      def self.mapper()
        @(Model.ConstructModelMapper())
      end
    end
  end
end
